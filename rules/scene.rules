rule "Lavoro"
when
    Item Scene_Lavoro changed to ON
then
  pushNotification("Scena: LAVORO", "La scena LAVORO è stata attivata")
  logInfo("Scene","Scena LAVORO: iniziata")

  gTappDog.sendCommand(DOWN)

  createTimer(now.plusSeconds(30), [|
    gScene.sendCommand(OFF)
    logInfo("Scene","Scena LAVORO: finita")
    ])
end

rule "A Casa"
when
    Item Scene_aCasa changed to ON
then
  pushNotification("Scena: A CASA", "La scena A CASA è stata attivata")
  logInfo("Scene","Scena A CASA: iniziata")

  gTappProd.sendCommand(UP)
  IPCams.sendCommand(OFF)

  createTimer(now.plusSeconds(30), [|
    AutoRientro.sendCommand(OFF) 
    gScene.sendCommand(OFF)
    logInfo("Scene","Scena A CASA: finita")
    ])
end

rule "Usciamo"
when
    Item Scene_Usciamo changed to ON
then
  pushNotification("Scena: USCIAMO", "La scena USCIAMO è stata attivata")
  logInfo("Scene","Scena USCIAMO: iniziata")

  gTappProd.sendCommand(DOWN)
  gLuci.sendCommand(OFF)

  createTimer(now.plusSeconds(30), [|
    IPCams.sendCommand(ON)
    gScene.sendCommand(OFF)
    logInfo("Scene","Scena USCIAMO: Telecamere accese e scena finita")
    ])
  createTimer(now.plusSeconds(300), [|
    AutoRientro.sendCommand(ON)
    ])
end


rule "Privacy "
when
    Item Scene_Privacy changed to ON
then
    logInfo("Scene","Scena PRIVACY: iniziata")
    gTappLvrm.sendCommand(DOWN)
    createTimer(now.plusSeconds(30), [|
      gScene.sendCommand(OFF)
      logInfo("Scene","Scena PRIVACY: finita")
    ])
end

rule "Chiudi tutto"
when
    Item Scene_Chiudi changed to ON
then
    logInfo("Scene","Scena CHIUDI: iniziata")
    gTappProd.sendCommand(DOWN)
    createTimer(now.plusSeconds(30), [|
      gScene.sendCommand(OFF)
      logInfo("Scene","Scena CHIUDI: finita")
    ])
end

rule "Vado a Letto"
when
    Item Scene_aLetto changed to ON
then
    logInfo("Scene","Scena A Letto: iniziata")
    gTappProd.sendCommand(DOWN)
    tsSoggiorno.sendCommand(OFF)
    logInfo("Scene","Scena A Letto: tapparelle abbassate")
    NAS2.sendCommand(OFF)
    Net_TV.sendCommand(OFF)
    Stereo.sendCommand(OFF)
    logInfo("Scene","Scena A Letto: Server, Stereo e PC spenti")
    sf04_Light.sendCommand(OFF)
    sf03_Light.sendCommand(OFF)
    logInfo("Scene","Scena A Letto: Luci soggiorno spente")
    createTimer(now.plusSeconds(30), [|
      Air_Conditioner_Temperature.sendCommand(10.0)
      logInfo("Scene","Scena A Letto: aria condizionata impostata a spenta: 10.0")
      gScene.sendCommand(OFF)
      logInfo("Scene","Scena A Letto: finita")
    ])
    createTimer(now.plusSeconds(3600), [|
      gLuci.sendCommand(OFF)
      logInfo("Scene","Scena A Letto: spente le luci")
    ])
end
